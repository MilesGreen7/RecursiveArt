;;; Scheme Recursive Art Contest Entry
;;;
;;; Please do not include your name or personal info in this file.
;;;
;;; Title: Night Train
;;;
;;; Description:
;;;    A train at twilight.
;;;    It breaks through the dark calm night.
;;;    How splendid a sight.

(define (draw)
  (speed 0)
  (pu)
  
  (seth 90)
  (fd 500)
  (seth 0)
  (bk 500)
  (color (rgb 0 0 0.298))
  (begin_fill)
  (fd 1000)
  (seth 270)
  (fd 1000)
  (seth 180)
  (fd 1000)
  (seth 90)
  (fd 1000)
  (end_fill)
  
  (seth 0)
  (fd 500)
  (seth 270)
  (fd 500)
  
  (color "#b9b9b9")
  (seth 270)
  (fd 350)
  (seth 180)
  (fd 200)
  (seth 0)
  
  (begin_fill)
  (fd 250)
  (seth 90)
  (fd 200)
  (seth 180)
  (fd 250)
  (seth 270)
  (fd 200)
  (end_fill)
  
  (seth 0)
  (fd 250)
  
  (begin_fill)
  (seth 60)
  (circle -200 60)
  (seth 0)
  (fd 1)
  
  (seth 300)
  (circle 200 60)
  (seth 180)
  (fd 1)
  (seth 60)
  
  (circle -200 60)
  (seth 180)
  (fd 10)
  (seth 270)
  (fd 200)
  (seth 0)
  (fd 10)
  (end_fill)
  
  (seth 60)
  (circle -200 48)
  (seth 200)
  (color "#a0a0a0")
  (begin_fill)
  (fd 284)
  (seth 90)
  (fd 135)
  (seth 0)
  (fd 250)
  (seth 300)
  (circle 200 12)
  (end_fill)
  (seth 108)
  (circle -200 12)
  
  (seth 270)
  (fd 120)
  (seth 180)
  (fd 90)
  (color "black")
  (begin_fill)
  (circle 20 360)
  (end_fill)
  (seth 90)
  (fd 2)
  (seth 180)
  (color "#9a9a9a")
  (begin_fill)
  (circle 18 360)
  (end_fill)
  (seth 90)
  (fd 2)
  (seth 180)
  (color "#ffa500")
  (begin_fill)
  (circle 16 360)
  (end_fill)
  (seth 90)
  (fd 6)
  (seth 180)
  (color "#f5f5a4")
  (begin_fill)
  (circle 10 360)
  (end_fill)
  (circle 10 40)
  
  (seth 230)
  (bk 10)
  (seth 225)
  (begin_fill)
  (fd 1000)
  (bk 1000)
  (seth 195)
  (fd 1000)
  (seth 0)
  (fd 800)
  (end_fill)
  (bk 800)
  (seth 195)
  (bk 1000)
  (seth 230)
  (fd 10)
  (seth 320)
  (circle -10 40)
  (seth 0)
  
  (fd 90)
  (seth 90)
  (fd 110)
  
  (seth 270)
  (fd 200)
  
  (seth 60)
  (color "#d3d3d3")
  (circle -200 15)
  
  (begin_fill)
  (fd 698)
  (bk 698)
  (circle -200 45)
  (seth 69)
  (pd)
  (fd 561)
  (end_fill)
  (pu)
  (bk 561)
  
  (color "#676767")
  (begin_fill)
  (fd 561)
  (bk 561)
  (seth 180)
  (fd 250)
  (seth 49.33)
  (fd 692)
  (end_fill)
  (bk 692)
  (seth 0)
  (fd 250)
  
  (color "black")
  (seth 69)
  (define (tcars spacing line-len radius curr-pos) 
             (cond ((and (< (+ curr-pos spacing) 561) (> spacing 0.3)) 
                       (begin (fd spacing) (seth 180) (pd) (fd line-len) (pu) 
                       (bk line-len) (seth 310.5) (pd) (circle radius 60) (pu) 
                       (seth 70.5) (circle (* -1 radius) 60) (seth 69) 
                       (tcars (* spacing 0.733) (* line-len  0.735) (* radius 0.735) 
                       (+ curr-pos spacing)))) 
                   (else (begin (bk curr-pos) (seth 180)))))
  (tcars 150 185 100 0)
 
  (bk 400)
  (seth 270)
  (fd 250)
  (color "#fafad2")
  (begin_fill)
  (circle 120 360)
  (end_fill)
  (bk 250)
  (seth 180)
  (fd 400)
  
  (color "#f5f5a4")
  (fd 60)
  (seth 270)
  (fd 25)
  (begin_fill)
  (fd 150)
  (seth 0)
  (seth 340)
  (circle -80 40)
  (seth 90)
  (fd 150)
  (seth 160)
  (circle -80 40)
  (end_fill)
  (seth 90)
  (fd 25)
  (seth 180)
  (bk 60)  
  
  (fd 80)
  (seth 61.85)
  (fd 40)
  (begin_fill)
  (fd 80)
  (seth 0)
  (fd 38)
  (seth 66.3)
  (bk 77)
  (seth 180)
  (fd 46)
  (end_fill)
  
  (define (windows spacing win-len win-height) 
             (cond ((> spacing 0.3) 
                      (begin (seth 61.85) (fd spacing) (begin_fill) 
                      (fd win-len) (seth 0) (fd (* 0.8444 win-height)) 
                      (seth 66.3) (bk (* 0.9625 win-len)) (seth 180) 
                      (fd win-height) (end_fill) (windows (* spacing 0.7358) 
                      (* win-len 0.7) (* win-height 0.7)))) 
                   (else (seth 61.85))))
  (windows 147 67 32)
  
  (ht)
  
  (exitonclick))

; Please leave this last line alone.  You may add additional procedures above
; this line.
(draw)